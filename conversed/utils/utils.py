import requests
import json


def _cleanup_empty_entries(data_dict):
    for key in data_dict.keys():
        if not data_dict[key]:
            del data_dict[key]
    return data_dict


def cleanup(data):
    orgs_list = data.get('organizations', False)
    if orgs_list:
        for org in orgs_list:
            org = _cleanup_empty_entries(org)
    for org in orgs_list:
        if not org:
            orgs_list.remove(org)
    data = _cleanup_empty_entries(data)
    return data


def initredis(POOL):
    import redis
    redis_server = redis.Redis(connection_pool=POOL)
    redis_server.set('sudip258@gmail.com', """{u'name': u'Iam Sudip', u'success': True, u'websites': [{u'url': u'http://iam-sudip.blogspot.in'}], u'email': u'sudip258@gmail.com', u'profile_picture': u'https://d2ojpxxtu63wzl.cloudfront.net/static/2a0092af80c9be7ad846bc04b79fa256_51837e606742d803cecec5eda8b6bff2e0ffe5b30f46ef609ed903a499140391', u'likelihood': 0.92, u'social_profiles': [{u'username': u'sudip258', u'typeId': u'gravatar', u'url': u'https://gravatar.com/sudip258', u'typeName': u'Gravatar', u'type': u'gravatar', u'id': u'46080451'}, {u'url': u'https://about.me/iamsudip', u'typeId': u'aboutme', u'username': u'iamsudip', u'type': u'aboutme', u'typeName': u'About.me'}, {u'username': u'I_amSudip', u'typeId': u'twitter', u'url': u'https://twitter.com/I_amSudip', u'typeName': u'Twitter', u'followers': 3, u'following': 16, u'type': u'twitter', u'id': u'368404788'}], u'extra_pictures': [u'https://d2ojpxxtu63wzl.cloudfront.net/static/2f87dc156b582009899cc29872c9a0bf_99542a0831252a0c36f5b2dee271c75fd0213bc73662e7fcf1bf5b766cf8405b']}""")
    redis_server.set('kushaldas@gmail.com', """{u'organizations': [{u'title': u'CPython Core Developer', u'name': u'Python Software Foundation', u'timespan': u'2014-04 - '}, {u'name': u'DSL Software'}, {u'title': u'Free Software lover', u'name': u'Red Hat'}, {u'name': u'Comat'}], u'name': u'Kushal Das', u'success': True, u'bio': u'Visit <a href="http://kushaldas.in" rel="nofollow" target="_blank">http://kushaldas.in</a><br />', u'gender': u'Male', u'topics': [u'Python', u'Photographers', u'Photography', u'Open Source', u'India'], u'websites': [{u'url': u'http://kushaldas.in'}], u'email': u'kushaldas@gmail.com', u'profile_picture': u'https://d2ojpxxtu63wzl.cloudfront.net/static/236c2ccf754f6d73cca0dbe851d1ad21_d1ef9d91adf4d4704b5070b906b1be830c42248ed7ba94bb78d6132df35ea7a3', u'location': u'Bangalore', u'position': u'Comat', u'likelihood': 0.91, u'social_profiles': [{u'username': u'kushaldas', u'typeId': u'klout', u'url': u'http://klout.com/kushaldas', u'typeName': u'Klout', u'type': u'klout', u'id': u'38280601597589379'}, {u'bio': u'Community Gardener at Eucalyptus Systems Inc.', u'typeId': u'linkedin', u'url': u'https://www.linkedin.com/pub/kushal-das/8/55b/5a6', u'typeName': u'LinkedIn', u'type': u'linkedin', u'id': u'kushal-das/8/55b/5a6'}, {u'username': u'kushaldas', u'bio': u'Photographer, FOSS developer, plays with Python. Interested in education. Fellow at Python Software Foundation. Community Gardener in Eucalyptus Systems.', u'typeId': u'twitter', u'url': u'https://twitter.com/kushaldas', u'typeName': u'Twitter', u'followers': 1072, u'following': 1368, u'type': u'twitter', u'id': u'14452322'}, {u'bio': u'Visit <a href="http://kushaldas.in" rel="nofollow" target="_blank">http://kushaldas.in</a><br />', u'typeId': u'googleplus', u'url': u'https://plus.google.com/u/0/114013331910661220533', u'typeName': u'GooglePlus', u'type': u'googleplus', u'id': u'114013331910661220533'}, {u'username': u'liveshowsphotos', u'typeId': u'facebook', u'url': u'https://www.facebook.com/liveshowsphotos', u'typeName': u'Facebook', u'type': u'facebook', u'id': u'100000186712778'}, {u'username': u'kushaldas', u'typeId': u'flickr', u'url': u'https://www.flickr.com/people/kushaldas', u'typeName': u'Flickr', u'type': u'flickr', u'id': u'88746839@n00'}, {u'username': u'kushaldas', u'typeId': u'gravatar', u'url': u'https://gravatar.com/kushaldas', u'typeName': u'Gravatar', u'type': u'gravatar', u'id': u'849903'}, {u'url': u'https://youtube.com/user/babaidas', u'typeId': u'youtube', u'username': u'babaidas', u'type': u'youtube', u'typeName': u'YouTube'}, {u'url': u'https://github.com/kushaldas', u'typeId': u'github', u'username': u'kushaldas', u'type': u'github', u'typeName': u'Github'}], u'extra_pictures': [u'https://d2ojpxxtu63wzl.cloudfront.net/static/aa7ced9f2302f2b1d10b6923fae54b35_ab41cb548206f906b075282c900d85017376e35cdd6b1851ed9ad6f24b3d4dcf', u'https://d2ojpxxtu63wzl.cloudfront.net/static/b95a8cb342d1be350b8bae2d294c198c_66298f3f2b3db48b17982cc816518f538605358a70130aa6ce182580d6136d62', u'https://d2ojpxxtu63wzl.cloudfront.net/static/90d58f5aeb627ed21a23d94f87ddb5f3_3b471c091881a95bd8fcd8dab745a81fc42c257d479d24febbba9c486323d25c', u'https://d2ojpxxtu63wzl.cloudfront.net/static/175835a3ffd9342b3141ec8fda2a88ba_3f5b87ed82b89fba4510f57232db06204d392aa75122474ea05f4b12e2878d2b', u'https://d2ojpxxtu63wzl.cloudfront.net/static/e95253a58ee099a2148f032b86126f86_056da93b800c26b5feb838a1efc302eacdc58a539bb6e821b047d4206f41a091']}""")
    redis_server.set('sayan.chowdhury2012@gmail.com', """{u'organizations': [{u'title': u'Software Developer', u'name': u'HackerEarth', u'timespan': u'2013-07 - '}, {u'title': u'Intern', u'name': u'HackerEarth', u'timespan': u'2013-01 - 2013-06'}, {u'title': u'Student Developer', u'name': u'Fedora Project', u'timespan': u'2013 - 2013'}, {u'title': u'Summer Intern', u'name': u'Tata Steel', u'timespan': u'2012-06 - 2012-07'}, {u'title': u'Student', u'name': u'Dr.B.C.Roy Engineering College'}, {u'title': u'Student Developer', u'name': u"Google Summer of Code '13"}], u'name': u'Sayan Chowdhury', u'success': True, u'bio': u'HackerEarth, Pythonista, Djangonaut, Linux User, VIM Lover, Formula One Fan, Photographer, Wannabe Mac user, Adventurer', u'gender': u'Male', u'websites': [{u'url': u'http://sayanchowdhury.dgplug.org'}], u'email': u'sayan.chowdhury2012@gmail.com', u'profile_picture': u'https://d2ojpxxtu63wzl.cloudfront.net/static/62c85884579b114935dd4c33b5ebbc9e_faa6709449dfcd48fc7032938b72e29a17ef47835b54b072adb54939f27d44b4', u'location': u'Durgapur', u'position': u"Student Developer, Google Summer of Code '13", u'likelihood': 0.88, u'social_profiles': [{u'username': u'synpro', u'typeId': u'facebook', u'url': u'https://www.facebook.com/synpro', u'typeName': u'Facebook', u'followers': 0, u'following': 0, u'type': u'facebook', u'id': u'1627117442'}, {u'username': u'sayanchowdhury', u'bio': u'Software Developer at HackerEarth', u'typeId': u'linkedin', u'url': u'https://www.linkedin.com/in/sayanchowdhury', u'typeName': u'LinkedIn', u'type': u'linkedin'}, {u'url': u'http://fosswithme.wordpress.com', u'typeId': u'wordpress', u'username': u'fosswithme', u'type': u'wordpress', u'typeName': u'Wordpress'}, {u'username': u'chowdhury_sayan', u'bio': u"@HackerEarth, GSoC'er 13, n00b Pythonista, Djangonaut, Linux User, VIM Lover, Formula One Fan, Photographer, Wannabe Mac user, Adventurer", u'typeId': u'twitter', u'url': u'https://twitter.com/chowdhury_sayan', u'typeName': u'Twitter', u'followers': 288, u'following': 510, u'type': u'twitter', u'id': u'53687449'}, {u'url': u'https://plus.google.com/114158551072146398273', u'typeId': u'googleplus', u'type': u'googleplus', u'id': u'114158551072146398273', u'typeName': u'GooglePlus'}, {u'url': u'http://about.me/sayanchowdhury', u'typeId': u'aboutme', u'type': u'aboutme', u'typeName': u'About.me'}, {u'url': u'https://github.com/sayanchowdhury', u'typeId': u'github', u'username': u'sayanchowdhury', u'type': u'github', u'typeName': u'Github'}, {u'url': u'https://foursquare.com/user/51736395', u'typeId': u'foursquare', u'type': u'foursquare', u'id': u'51736395', u'typeName': u'Foursquare'}, {u'username': u'sayanchowdhury', u'typeId': u'angellist', u'bio': u'HackerEarth, Pythonista, Djangonaut, Linux User, VIM Lover, Formula One Fan, Photographer, Wannabe Mac user, Adventurer', u'url': u'https://angel.co/sayanchowdhury', u'typeName': u'AngelList', u'followers': 33, u'type': u'angellist', u'id': u'200931'}, {u'username': u'sayanchowdhury', u'typeId': u'gravatar', u'url': u'http://gravatar.com/sayanchowdhury', u'typeName': u'Gravatar', u'type': u'gravatar', u'id': u'27479740'}, {u'username': u'chowdhury_sayan', u'typeId': u'klout', u'url': u'http://klout.com/user/chowdhury_sayan', u'typeName': u'Klout', u'type': u'klout', u'id': u'52917300386372246'}], u'extra_pictures': [u'https://d2ojpxxtu63wzl.cloudfront.net/static/ee8842f257dcbabe2ab0849f8df93b6b_7f18fe9f78dff7562a53124a8df2e44ac8a55fe19953281f9fffa0a0b31b6544', u'https://d2ojpxxtu63wzl.cloudfront.net/static/56373c7e0a3510ca34ca641b07c4eee5_1da23a83dd2531e22f6cea94eed59aa74502f624190fe26dabe130c07e0e48b6', u'https://d2ojpxxtu63wzl.cloudfront.net/static/b0b91d09b7ec9f6cf19e116aa747d52f_6d3f7703a5abbae1af81057d7621d71d86a0bcdda274949ab706fd88a79f20e9', u'https://d2ojpxxtu63wzl.cloudfront.net/static/b360abe66575165f94b8d2a853b2de5f_051e5df0c3a7b061a7c4b2612f08f9f725afcaff1ba3b2ebdc560cbd69d4e8e6', u'https://d2ojpxxtu63wzl.cloudfront.net/static/eaec989d5269f9e47d48ad3a3556e4e3_cc33ddfad562822caa9cac91a86d87ce265dd765fbcea6c875575aa6364ad176', u'https://d2ojpxxtu63wzl.cloudfront.net/static/0b0f9ae9f4b63d272f8621f9c31bd13c_f708e8342b5044bf8ab9dee99c3baa89c3031ffe00e008b57a4ec7378cea2f51', u'https://d2ojpxxtu63wzl.cloudfront.net/static/9bfa082e4b5abd3bc91714bf2811440c_880dfd7490afeddf4a0dd53f723d24e643754611246cf9c3c9dd05be2672709a']}""")
    redis_server.set('iamsudip258@gmail.com', """{u'name': u'Iamsudip', u'success': True, u'bio': u'Pythonista, Linux user', u'gender': u'Male', u'email': u'iamsudip258@gmail.com', u'profile_picture': u'https://d2ojpxxtu63wzl.cloudfront.net/static/929b84fd648e1a4673a16e94023e7cbf_bc6e0cdadb65a56136b9cd943bd317f451f3412ab3197aa7a856e069ee6a5743', u'location': u'Bardhaman, West Bengal, India', u'likelihood': 0.88, u'social_profiles': [{u'url': u'https://about.me/iamsudip', u'typeId': u'aboutme', u'username': u'iamsudip', u'type': u'aboutme', u'typeName': u'About.me'}, {u'bio': u'Student at Dr. B. C. Roy Engineering College', u'typeId': u'linkedin', u'url': u'https://www.linkedin.com/pub/sudip-maji/88/821/277', u'typeName': u'LinkedIn', u'type': u'linkedin', u'id': u'sudip-maji/88/821/277'}, {u'username': u'iamsudip', u'bio': u'Pythonista, Linux user', u'typeId': u'angellist', u'url': u'https://angel.co/iamsudip', u'typeName': u'AngelList', u'followers': 1, u'following': 0, u'type': u'angellist', u'id': u'494291'}, {u'username': u'iamsudip13', u'typeId': u'facebook', u'url': u'https://www.facebook.com/iamsudip13', u'typeName': u'Facebook', u'type': u'facebook', u'id': u'100003613494318'}, {u'username': u'iamsudipy', u'typeId': u'twitter', u'url': u'https://twitter.com/iamsudipy', u'typeName': u'Twitter', u'followers': 204, u'following': 50, u'type': u'twitter', u'id': u'368404788'}, {u'url': u'https://github.com/iamsudip', u'typeId': u'github', u'username': u'iamsudip', u'type': u'github', u'typeName': u'Github'}], u'extra_pictures': [u'https://d2ojpxxtu63wzl.cloudfront.net/static/2a0092af80c9be7ad846bc04b79fa256_51837e606742d803cecec5eda8b6bff2e0ffe5b30f46ef609ed903a499140391', u'https://d2ojpxxtu63wzl.cloudfront.net/static/a3dc09ab2058f451fa1a4c17ddc84afe_2d11983674fd1107551e4473845713639134e0b89af198dd74e90b420732634b', u'https://d2ojpxxtu63wzl.cloudfront.net/static/f23c36adf646523c5fb94fe8fd523ba5_e1c8e176abdf1eed0546856d12cdc63bda84f15547a4085f30ba813f2f6cda5b']}""")
    redis_server.set('arjun@profoundis.com', """{u'organizations': [{u'title': u'CEO & Co-Founder', u'name': u'Profoundis Labs', u'timespan': u'2012 - '}, {u'title': u'Co-founder & Chief Executive Officer', u'name': u'Profoundis', u'timespan': u'2012-04 - '}, {u'title': u'Member', u'name': u'IEEE MGA GOLD Industry Working group', u'timespan': u'2012-03 - 2012-12'}, {u'title': u'Systems Engineer', u'name': u'Infosys', u'timespan': u'2010-09 - 2012-04'}, {u'title': u'Systems Engineer', u'name': u'Infosys', u'timespan': u'2010 - 2012'}, {u'title': u'Sub Student Representative', u'name': u'IEEE Asia Pacific Student Activities Commitee', u'timespan': u'2009-11 - 2010-12'}, {u'title': u'Executive Commitee Member', u'name': u'IEEE Kerala Section Student Activities', u'timespan': u'2009-01 - 2009-12'}, {u'title': u'Manager', u'name': u'Google Business Group Cochin'}, {u'title': u'Executive Committee Member', u'name': u'Asia Pacific Student Actvities Commitee'}], u'name': u'Arjun Pillai', u'success': True, u'bio': u"I'm currently running my Startup - Profoundis (www.profoundis.com). \nMy FB - https://www.facebook.com/rarjunpillai\nMy LinkedIn - http://www.linkedin.com/profile/view?id=79711386&amp;trk=tab_pro", u'gender': u'Male', u'topics': [u'Profoundis', u'Latest News', u'Current Affairs', u'Journalism', u'India', u'Books'], u'domain_title': u'Profoundis :: Business Analytics :: Business Optimization', u'websites': [{u'url': u'http://arjunrpillai.com'}, {u'url': u'http://profoundis.com'}, {u'url': u'http://arjunrpillai.me'}], u'email': u'arjun@profoundis.com', u'profile_picture': u'https://d2ojpxxtu63wzl.cloudfront.net/static/5fefadf7712dd951144163a0e9bebf89_4cc4c3655184702570440ebe123368eb10e4794deaa964670ee682cbd82e5000', u'location': u'San Francisco', u'domain_desc': u'Profoundis. The Intelligence Company. Business optimization. Business Intelligence. Online Presence. Profoundis envisions touching the lives of people by creating a range of visionary products and delivering services with distinctions. We are a team of Technology and Management Enthusiasts coming together for the same cause. The Momenttous business suite from Profoundis offers world class business optimization and analytics solutions.', u'position': u'Executive Committee Member, Asia Pacific Student Actvities Commitee', u'likelihood': 0.92, u'social_profiles': [{u'username': u'rarjunpillai', u'bio': u"I love working with problems and trying to put my 2 cents to solve it. I pursue my entrepreneurship dream, Profoundis (www.profoundis.com) as a co-founder along with my 3 friends Anoop, Jofin and Nithin. Besides, I'm an active volunteer with IEEE (www.ieee.org).I love playing games, watching movies, hearing Music. Infact I love to do a lot of things at a time. :)", u'typeId': u'aboutme', u'url': u'https://about.me/rarjunpillai', u'typeName': u'About.me', u'type': u'aboutme'}, {u'url': u'http://orkut.com/Main#Profile.aspx?uid=9137537516166067827', u'typeId': u'orkut', u'type': u'orkut', u'id': u'9137537516166067827', u'typeName': u'Other'}, {u'url': u'https://foursquare.com/user/44775255', u'typeId': u'foursquare', u'type': u'foursquare', u'id': u'44775255', u'typeName': u'Foursquare'}, {u'username': u'rarjunpillai', u'bio': u'Co-founder & CEO@Profoundis, Speaker, Volunteer', u'typeId': u'linkedin', u'url': u'https://www.linkedin.com/in/rarjunpillai', u'typeName': u'LinkedIn', u'type': u'linkedin'}, {u'url': u'http://klout.com/4nearme', u'typeId': u'klout', u'username': u'4nearme', u'type': u'klout', u'typeName': u'Klout'}, {u'username': u'rarjunpillai', u'typeId': u'facebook', u'url': u'https://www.facebook.com/rarjunpillai', u'typeName': u'Facebook', u'followers': 3090, u'following': 3090, u'type': u'facebook'}, {u'username': u'4nearme', u'typeId': u'twitter', u'url': u'https://twitter.com/4nearme', u'typeName': u'Twitter', u'followers': 33, u'following': 73, u'type': u'twitter'}, {u'username': u'rarjunpillai', u'bio': u'Founder at Vibeapp.co, Founder & CEO @profoundis Labs \u2022 Worked at @infosys-technologies \u2022 Online & Offline Marketing', u'typeId': u'angellist', u'url': u'https://angel.co/rarjunpillai', u'typeName': u'AngelList', u'followers': 431, u'following': 0, u'type': u'angellist'}, {u'url': u'http://www.quora.com/Arjun-R-Pillai', u'typeId': u'quora', u'username': u'Arjun-R-Pillai', u'type': u'quora', u'typeName': u'Quora'}, {u'username': u'rarjunpillai', u'typeId': u'pinterest', u'url': u'http://www.pinterest.com/rarjunpillai/', u'typeName': u'Pinterest', u'followers': 148, u'following': 45, u'type': u'pinterest'}, {u'url': u'http://rarjunpillai.wordpress.com', u'typeId': u'wordpress', u'username': u'rarjunpillai', u'type': u'wordpress', u'typeName': u'Wordpress'}, {u'url': u'https://plus.google.com/u/0/105118993533807422556', u'typeId': u'google', u'type': u'google', u'id': u'105118993533807422556', u'typeName': u'GooglePlus'}, {u'username': u'rarjunpillai', u'bio': u"I'm currently running my Startup - Profoundis (www.profoundis.com). \nMy FB - https://www.facebook.com/rarjunpillai\nMy LinkedIn - http://www.linkedin.com/profile/view?id=79711386&amp;trk=tab_pro", u'typeId': u'gravatar', u'url': u'https://gravatar.com/rarjunpillai', u'typeName': u'Gravatar', u'type': u'gravatar'}, {u'url': u'https://www.flickr.com/people/rarjunpillai', u'typeId': u'flickr', u'username': u'rarjunpillai', u'type': u'flickr', u'typeName': u'Flickr'}], u'extra_pictures': [u'https://d2ojpxxtu63wzl.cloudfront.net/static/5ef956e17f5361df047f03fb139b9cb0_787842fda3ab1b78d628d7cccc732813790b282694dc299fa4a50e2d97d02915', u'https://d2ojpxxtu63wzl.cloudfront.net/static/e9eb881024778c92fdbd784142161739_6c98cdd01a7e8f18aff3739d9ad0c9e768c44850231ab93fdcc53576605b401f', u'https://d2ojpxxtu63wzl.cloudfront.net/static/fe7e2e6fa68e69052ce91e5c36d9b42c_e66bdfd11b19ca01ab0a13a0f7935006a19f1ae8d6b6c6a496d46a3fdeea2baa', u'https://d2ojpxxtu63wzl.cloudfront.net/static/6cc76f2b2aa144ac3432027da6d00ac9_9fa5d8740d8401c2ac12953fe37d40eeb342391ba8b7f28bf4a591a277d42498', u'https://d2ojpxxtu63wzl.cloudfront.net/static/a9972156bba9ddc1699257f60300a2a8_9c14701fec7672badec0b6300d0ba0b6ad6bda0dd89649e7590e4f6a9e6b5e22', u'https://d2ojpxxtu63wzl.cloudfront.net/static/8864966e834dfe7b9ca157a62a3ab74a_b7f0b10a4bf7faf5e3501cbc59499772e553fb7db0e42f741159b4316a5611be', u'https://d2ojpxxtu63wzl.cloudfront.net/static/1e6cb9bbcb3b3d2fd26dc6232effa46f_d0f618c2d4a8d5c3b1d8e1375f60882e06bb56386613919453406a5b8900e871', u'https://d2ojpxxtu63wzl.cloudfront.net/static/9932b283320912c0c295083cc34c7865_df0c94b8411c7ae2968f535b8dde54d425f4ba49ca7ff948b6a3078a838a238e']}""")
